<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Argp++: Examples</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Argp++
   &#160;<span id="projectnumber">0.9.0 (beta)</span>
   </div>
   <div id="projectbrief">a C++ wrapper around the GNU argument parser library &quot;argp&quot;</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d8/d84/a00001.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Examples </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>There are ten demo programs in the "examples" folder illustrating usage of the <b>Argp++</b> library. Nine of these are taken from the "step" examples in the book <a href="http://www.nongnu.org/argpbook/" target="_blank" style="font-style:italic;font-weight:bold">&ldquo;Step-By-Step Into Argp&rdquo;</a>&#160;by Ben Asselstine (Copyright &copy; 2010, 2015). The example <b>argpp_test.cpp</b> was taken from GNU glib source code in <a href="https://github.com/lattera/glibc/blob/master/argp/argp-test.c" target="_blank">argp-test.c.</a><br />
 <br />
 I only implemented up to and including Step 8 in the book because the last steps require linking other GNU libraries to the program such as <b><em>argz</em></b> and <b><em>readline</em></b>. Since the wrapper classes are intended to work with stand-alone implementations of <em>argp</em>, it would have introduced unnecessary complexity for those users. I am sure it would be quite possible to do, so I am leaving this as an exercise for the user. </p><hr/>
<p> Here are links to the source code of the examples: </p>
<h1><a class="anchor" id="exsources"></a>
Example sources:</h1>
<ol type="1">
<li><a class="el" href="../../d8/d84/a00001.html#boilerplate">boilerplate.cpp</a></li>
<li><a class="el" href="../../d8/d84/a00001.html#argp_test">ex_argp_test.cpp</a></li>
<li><a class="el" href="../../d8/d84/a00001.html#step0">ex_step_0.cpp</a></li>
<li><a class="el" href="../../d8/d84/a00001.html#step1">ex_step_1.cpp</a></li>
<li><a class="el" href="../../d8/d84/a00001.html#step2">ex_step_2.cpp</a></li>
<li><a class="el" href="../../d8/d84/a00001.html#step3">ex_step_3.cpp</a></li>
<li><a class="el" href="../../d8/d84/a00001.html#step4">ex_step_4.cpp</a></li>
<li><a class="el" href="../../d8/d84/a00001.html#step5">ex_step_5.cpp</a></li>
<li><a class="el" href="../../d8/d84/a00001.html#step6">ex_step_6.cpp</a></li>
<li><a class="el" href="../../d8/d84/a00001.html#step7">ex_step_7.cpp</a></li>
<li><a class="el" href="../../d8/d84/a00001.html#step8">ex_step_8.cpp</a> <hr/>
</li>
</ol>
<h1><a class="anchor" id="boilerplate"></a>
boilerplate.cpp</h1>
<p><span style="background-color:yellow"> This contains functions used by all of the demo programs. It is used to build a convenience library which is linked into the example programs when <code>&ldquo;make&#160;examples&rdquo;</code> is entered on the command line. </span> </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">   Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">   modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">   version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">   Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">   Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">   Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">   Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">string</span> prg_name;</div><div class="line"></div><div class="line"><span class="comment">//-----------------------------------------------------------------------</span></div><div class="line"><span class="comment">// code that is always the same for each test:</span></div><div class="line"><span class="comment">//-----------------------------------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> do_boilerplate(<a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* root, <span class="keywordtype">bool</span> parse_retval);</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> do_test()</div><div class="line">{</div><div class="line">  <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* root = <a class="code" href="../../d1/d7c/a00003.html#af58f4baf37b3e6b771d0926f482f9b15">ArgppBase::getRootInstance</a>();</div><div class="line">  <span class="keywordflow">if</span> (root) {</div><div class="line">    <span class="comment">//----------------------------------------------------------</span></div><div class="line">    <span class="comment">// This function will not return if the user entered</span></div><div class="line">    <span class="comment">// &quot;--help&quot;, &quot;--usage&quot;, or &quot;--version&quot; on the command line,</span></div><div class="line">    <span class="comment">// or if an invalid option was entered, because argp_parse()</span></div><div class="line">    <span class="comment">// calls exit() before returning:</span></div><div class="line">    <span class="comment">//----------------------------------------------------------</span></div><div class="line">    <span class="keywordtype">bool</span> ret = <a class="code" href="../../d1/d7c/a00003.html#a636e133fd2c194a1794de170b8694c9b">ArgppBase::parse</a>();</div><div class="line">    <span class="comment">//----------------------------------------------------------</span></div><div class="line">    <span class="comment">// However, since there are (hopefully) only global and static</span></div><div class="line">    <span class="comment">// objects created up to now, the C++ standard guarantees that</span></div><div class="line">    <span class="comment">// their destructors will be called before terminating the</span></div><div class="line">    <span class="comment">// program.</span></div><div class="line">    <span class="comment">//----------------------------------------------------------</span></div><div class="line">    do_boilerplate(root, ret);</div><div class="line">  } <span class="keywordflow">else</span> {</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;ARGPP ERROR: No root instance available!\n&quot;</span>;</div><div class="line">  }</div><div class="line">  cout &lt;&lt; <span class="stringliteral">&quot;ARGPP TEST: &quot;</span> &lt;&lt; prg_name &lt;&lt; <span class="stringliteral">&quot; finished.&quot;</span> &lt;&lt; endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//-----------------------------------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> do_boilerplate(<a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* root, <span class="keywordtype">bool</span> parse_retval)</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version</div><div class="line">    = argp_program_version ? argp_program_version : <span class="stringliteral">&quot;&lt;unknown version&gt;&quot;</span>;</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (root &amp;&amp; parse_retval) {</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;\n^^^ Output from &quot;</span> &lt;&lt; prg_name &lt;&lt; <span class="stringliteral">&quot; ^^^\n&quot;</span>;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;==========================================================\n&quot;</span>;</div><div class="line">    <span class="keyword">const</span> <a class="code" href="../../d2/de7/a00014.html#a651c83b915460354a157063ce971fb98">ParsedOptions</a>&amp; po = root-&gt;<a class="code" href="../../d1/d7c/a00003.html#ac6fa60e201ba6d5ced56ffad0fb9baf2">getParsedOptions</a>();</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;ARGPP TEST: &quot;</span> &lt;&lt; prg_version &lt;&lt; <span class="stringliteral">&quot; begin...\n&quot;</span>;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Options parsed:\n&quot;</span>;</div><div class="line">    <span class="keywordflow">if</span> (!po.empty()) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;\tShort:\tLong:\tArgument:\n&quot;</span>;</div><div class="line">      <span class="keywordflow">for</span> (<a class="code" href="../../d2/de7/a00014.html#a01e1d7027039860459baa649f637a867">P_Opts_cit</a> cit = po.begin();</div><div class="line">           cit != po.end(); ++cit) {</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line">        <span class="keywordflow">if</span> (isprint(cit-&gt;key_)) {</div><div class="line">          cout &lt;&lt; (char)(cit-&gt;key_);</div><div class="line">        } <span class="keywordflow">else</span> {</div><div class="line">          cout &lt;&lt; cit-&gt;key_;</div><div class="line">        }</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div><div class="line">             &lt;&lt; (cit-&gt;long_name_.empty() ? <span class="stringliteral">&quot;(no long name)&quot;</span> : cit-&gt;long_name_)</div><div class="line">             &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div><div class="line">             &lt;&lt; cit-&gt;arg_ &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">      }</div><div class="line">    } <span class="keywordflow">else</span> {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;No parsed options were saved.\n&quot;</span>;</div><div class="line">    }</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;----------------\n&quot;</span>;</div><div class="line">    <span class="comment">//---------------------------------------------------</span></div><div class="line">    <span class="comment">// Get the non-option arguments:</span></div><div class="line">    <span class="comment">//---------------------------------------------------</span></div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Non-option arguments entered:\n&quot;</span>;</div><div class="line">    <span class="keyword">const</span> <a class="code" href="../../d2/de7/a00014.html#aa267d4438bf2e5dd92029ae69e1e7d1f">OtherArgs</a>&amp; ar = root-&gt;<a class="code" href="../../d1/d7c/a00003.html#a198dd8f272665b1daa978172a1d51631">getNonOptionArgs</a>();</div><div class="line">    <span class="keywordflow">if</span> (!ar.empty()) {</div><div class="line">        <span class="keywordflow">for</span> (OtherArgs::const_iterator cit = ar.begin();</div><div class="line">             cit != ar.end(); ++cit) {</div><div class="line">          cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; *cit &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">        }</div><div class="line">    } <span class="keywordflow">else</span> {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;None.\n&quot;</span>;</div><div class="line">    }</div><div class="line">  } <span class="keywordflow">else</span> {</div><div class="line">    error_t e = <a class="code" href="../../d1/d7c/a00003.html#a6c2972469897f06e388f4e8ef755d3cf">ArgppBase::getRetvalErrorFromArgpParse</a>();</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;parse() returned false...\nError code from argp_parse was: &quot;</span> &lt;&lt; e;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; strerror(e) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
<hr/>
<h1><a class="anchor" id="argp_test"></a>
ex_argp_test.cpp</h1>
<p><span style="background-color:yellow"> Based on the file <b>argp-test.c</b> located here: <a href="https://github.com/lattera/glibc/blob/master/argp/argp-test.c">https://github.com/lattera/glibc/blob/master/argp/argp-test.c</a> </span> </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">   Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">   modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">   version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">   Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">   Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">   Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">   Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cstdio&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">string</span> prg_name;</div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> do_test();</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version  = <span class="stringliteral">&quot;version 1.0 (originally: \&quot;argp-test 1.0\&quot;)&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> bug_addr     = <span class="stringliteral">&quot;&lt;code@roberthairgrove.com&gt;&quot;</span>;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> sub_args_doc = <span class="stringliteral">&quot;STRING...\n-&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> sub_doc      = <span class="stringliteral">&quot;\vThis is the doc string from the sub-arg-parser.&quot;</span>;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> args_doc = <span class="stringliteral">&quot;STRING&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> doc      = <span class="stringliteral">&quot;Test program for argp.&quot;</span></div><div class="line">                               <span class="stringliteral">&quot;\vThis doc string comes after the options.&quot;</span></div><div class="line">                               <span class="stringliteral">&quot;\nHey!  Some manual formatting!&quot;</span></div><div class="line">                               <span class="stringliteral">&quot;\nThe current time is: %s&quot;</span>;</div><div class="line"></div><div class="line"><span class="comment">/* Structure used to communicate with the parsing functions.  */</span></div><div class="line"><span class="keyword">struct </span>params</div><div class="line">{</div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> foonly;      <span class="comment">/* Value parsed for foonly.  */</span></div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> foonly_default;  <span class="comment">/* Default value for it.  */</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="preprocessor">#define OPT_PGRP 1</span></div><div class="line"><span class="preprocessor">#define OPT_SESS 2</span></div><div class="line"></div><div class="line"><span class="comment">//-------------------------------------------------------------------------</span></div><div class="line"><span class="comment">// In C++, all of the members of the struct must be initialized explicitly:</span></div><div class="line"><span class="comment">//-------------------------------------------------------------------------</span></div><div class="line">argp_option sub_options[] =</div><div class="line">{</div><div class="line">  {<span class="stringliteral">&quot;subopt1&quot;</span>,       <span class="charliteral">&#39;s&#39;</span>,     0,  0, <span class="stringliteral">&quot;Nested option 1&quot;</span>, 0},</div><div class="line">  {<span class="stringliteral">&quot;subopt2&quot;</span>,       <span class="charliteral">&#39;S&#39;</span>,     0,  0, <span class="stringliteral">&quot;Nested option 2&quot;</span>, 0},</div><div class="line"></div><div class="line">  { 0, 0, 0, 0, <span class="stringliteral">&quot;Some more nested options:&quot;</span>, 10},</div><div class="line">  {<span class="stringliteral">&quot;subopt3&quot;</span>,       <span class="charliteral">&#39;p&#39;</span>,     0,  0, <span class="stringliteral">&quot;Nested option 3&quot;</span>, 0},</div><div class="line"></div><div class="line">  {<span class="stringliteral">&quot;subopt4&quot;</span>,       <span class="charliteral">&#39;q&#39;</span>,     0,  0, <span class="stringliteral">&quot;Nested option 4&quot;</span>, 1},</div><div class="line"></div><div class="line">  {0,0,0,0,0,0}</div><div class="line">};</div><div class="line"></div><div class="line">argp_option options[] =</div><div class="line">{</div><div class="line">  {<span class="stringliteral">&quot;pid&quot;</span>,       <span class="charliteral">&#39;p&#39;</span>,     <span class="stringliteral">&quot;PID&quot;</span>, 0, <span class="stringliteral">&quot;List the process PID&quot;</span>, 0},</div><div class="line">  {<span class="stringliteral">&quot;pgrp&quot;</span>,      OPT_PGRP,<span class="stringliteral">&quot;PGRP&quot;</span>,0, <span class="stringliteral">&quot;List processes in the process group PGRP&quot;</span>, 0},</div><div class="line">  {<span class="stringliteral">&quot;no-parent&quot;</span>, <span class="charliteral">&#39;P&#39;</span>,     0,     0, <span class="stringliteral">&quot;Include processes without parents&quot;</span>, 0},</div><div class="line">  {0,           <span class="charliteral">&#39;x&#39;</span>,     0,     OPTION_ALIAS, 0, 0},</div><div class="line">  {<span class="stringliteral">&quot;all-fields&quot;</span>,<span class="charliteral">&#39;Q&#39;</span>,     0,     0, <span class="stringliteral">&quot;Don&#39;t elide unusable fields (normally&quot;</span></div><div class="line">           <span class="stringliteral">&quot; if there&#39;s some reason ps can&#39;t&quot;</span></div><div class="line">           <span class="stringliteral">&quot; print a field for any process, it&#39;s&quot;</span></div><div class="line">           <span class="stringliteral">&quot; removed from the output entirely)&quot;</span>, 0 },</div><div class="line">  {<span class="stringliteral">&quot;reverse&quot;</span>,   <span class="charliteral">&#39;r&#39;</span>,    0,      0, <span class="stringliteral">&quot;Reverse the order of any sort&quot;</span>, 0},</div><div class="line">  {<span class="stringliteral">&quot;gratuitously-long-reverse-option&quot;</span>, 0, 0, OPTION_ALIAS, 0, 0},</div><div class="line">  {<span class="stringliteral">&quot;session&quot;</span>,  OPT_SESS,<span class="stringliteral">&quot;SID&quot;</span>,  OPTION_ARG_OPTIONAL,</div><div class="line">           <span class="stringliteral">&quot;Add the processes from the session&quot;</span></div><div class="line">           <span class="stringliteral">&quot; SID (which defaults to the sid of&quot;</span></div><div class="line">           <span class="stringliteral">&quot; the current process)&quot;</span>, 0 },</div><div class="line"></div><div class="line">  {0,0,0,0, <span class="stringliteral">&quot;Here are some more options:&quot;</span>, 0},</div><div class="line">  {<span class="stringliteral">&quot;foonly&quot;</span>, <span class="charliteral">&#39;f&#39;</span>, <span class="stringliteral">&quot;ZOT&quot;</span>, OPTION_ARG_OPTIONAL, <span class="stringliteral">&quot;Glork a foonly&quot;</span>, 0},</div><div class="line">  {<span class="stringliteral">&quot;zaza&quot;</span>, <span class="charliteral">&#39;z&#39;</span>, 0, 0, <span class="stringliteral">&quot;Snit a zar&quot;</span>, 0},</div><div class="line">  <span class="comment">// another way of delimiting an options array:</span></div><div class="line">  argp_option()</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//---------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line">popt (<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg)</div><div class="line">{</div><div class="line">  <span class="keywordtype">char</span> buf[10];</div><div class="line">  <span class="keywordflow">if</span> (isprint (key))</div><div class="line">    sprintf (buf, <span class="stringliteral">&quot;%c&quot;</span>, key);</div><div class="line">  <span class="keywordflow">else</span></div><div class="line">    sprintf (buf, <span class="stringliteral">&quot;%d&quot;</span>, key);</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (arg)</div><div class="line">    printf (<span class="stringliteral">&quot;KEY %s: %s\n&quot;</span>, buf, arg);</div><div class="line">  <span class="keywordflow">else</span></div><div class="line">    printf (<span class="stringliteral">&quot;KEY %s\n&quot;</span>, buf);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//---------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="keyword">class </span>Argex_test : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Argex_test(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">      : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent)</div><div class="line">    {</div><div class="line">      params_.foonly = 0;</div><div class="line">      params_.foonly_default = random();</div><div class="line">      installHelpFilter();</div><div class="line">    }</div><div class="line">    params params_;</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    <span class="comment">//--------------------------------------</span></div><div class="line"><span class="comment"></span>    error_t parserImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *state) {</div><div class="line">      <span class="comment">// record it:</span></div><div class="line">      genericParserImpl(key, arg, state);</div><div class="line">      error_t retval = <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">      <span class="keywordflow">switch</span>(key) {</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div><div class="line">          <span class="keywordflow">if</span> (arg)</div><div class="line">            params_.foonly = strtoul(arg, NULL, 10);</div><div class="line">          <span class="keywordflow">else</span></div><div class="line">            params_.foonly = params_.foonly_default;</div><div class="line">          popt(key, arg);</div><div class="line">          <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;P&#39;</span>: <span class="keywordflow">case</span> OPT_PGRP: <span class="keywordflow">case</span> <span class="charliteral">&#39;x&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;Q&#39;</span>:</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>: <span class="keywordflow">case</span> OPT_SESS: <span class="keywordflow">case</span> <span class="charliteral">&#39;z&#39;</span>:</div><div class="line">          popt(key, arg);</div><div class="line">          <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">          retval = <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>;</div><div class="line">          <span class="keywordflow">break</span>;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> retval;</div><div class="line">    }</div><div class="line">    <span class="comment">//-------------------------------------</span></div><div class="line"><span class="comment"></span>    error_t keyNoArgsImpl(argp_state *) {</div><div class="line">      printf (<span class="stringliteral">&quot;NO ARGS\n&quot;</span>);</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">    }</div><div class="line">    <span class="comment">//-------------------------------------</span></div><div class="line"><span class="comment"></span>    error_t keyArgImpl(<span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *state) {</div><div class="line">      <span class="keywordflow">if</span> (state-&gt;arg_num &gt; 0)</div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>; <span class="comment">/* Leave it for the sub-arg parser.  */</span></div><div class="line">      printf (<span class="stringliteral">&quot;ARG: %s\n&quot;</span>, arg);</div><div class="line">      <span class="comment">// record it:</span></div><div class="line">      ArgppBase::keyArgImpl(arg, state);</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">    }</div><div class="line">    <span class="comment">//-------------------------------------</span></div><div class="line"><span class="comment"></span>    <span class="keywordtype">string</span> helpFilterImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> * text) {</div><div class="line">      <span class="keywordtype">string</span> retval;</div><div class="line">      <span class="keywordtype">int</span> res = -1;</div><div class="line">      <span class="keywordtype">char</span> new_text[1024];</div><div class="line">      <span class="keywordflow">if</span> (text &amp;&amp; (key == <a class="code" href="../../d2/de7/a00014.html#af2f25066604483292c7fe86a8c90f767a2224b90fd50d469eca38ca55c7209358">khp_post_doc</a>)) {</div><div class="line">        time_t now = time (0);</div><div class="line">        res = snprintf(new_text, 1024, text, ctime (&amp;now));</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (text &amp;&amp; key == <span class="charliteral">&#39;f&#39;</span>) {</div><div class="line">        <span class="comment">/* Show the default for the --foonly option.  */</span></div><div class="line">        res = snprintf(new_text, 1024, <span class="stringliteral">&quot;%s (ZOT defaults to %x)&quot;</span>,</div><div class="line">            text, params_.foonly_default);</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (text) {</div><div class="line">        retval = string(text);</div><div class="line">      }</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> ((res &gt; 0) &amp;&amp; (res &lt; 1024))</div><div class="line">        retval = string(new_text);</div><div class="line">      <span class="keywordflow">return</span> retval;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//---------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="keyword">class </span>Argex_child : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Argex_child(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">      : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent) {}</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    <span class="comment">//------------------------------------------------</span></div><div class="line"><span class="comment"></span>    error_t parserImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *state) {</div><div class="line">      error_t retval = <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">      <span class="keywordflow">switch</span>(key) {</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span> : <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>: <span class="keywordflow">case</span> <span class="charliteral">&#39;q&#39;</span>:</div><div class="line">          genericParserImpl(key, arg, state);</div><div class="line">          printf (<span class="stringliteral">&quot;SUB KEY %c\n&quot;</span>, key);</div><div class="line">          <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">          retval = <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> retval;</div><div class="line">    }</div><div class="line">    <span class="comment">//------------------------------------------------</span></div><div class="line"><span class="comment"></span>    error_t keyNoArgsImpl(argp_state *) {</div><div class="line">      printf (<span class="stringliteral">&quot;NO SUB ARGS\n&quot;</span>);</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">    }</div><div class="line">    <span class="comment">//------------------------------------------------</span></div><div class="line"><span class="comment"></span>    error_t keyArgImpl(<span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *) {</div><div class="line">      printf (<span class="stringliteral">&quot;SUB ARG: %s\n&quot;</span>, arg);</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="keywordtype">bool</span> setup_parsers(<span class="keywordtype">int</span> cargc, <span class="keywordtype">char</span>** vargv) {</div><div class="line"></div><div class="line">  <span class="keywordtype">bool</span> retval = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">  <span class="comment">// create the root instance:</span></div><div class="line">  Argex_test* root = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_test&gt;::createParser</a>(cargc, vargv);</div><div class="line"></div><div class="line">  <span class="comment">//------------------------------------------------------</span></div><div class="line">  <span class="comment">// The child is automatically attached to root as its parent.</span></div><div class="line">  <span class="comment">// Any additional children should specify their parent:</span></div><div class="line">  <span class="comment">//------------------------------------------------------</span></div><div class="line">  Argex_child* child = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_child&gt;::createParser</a>();</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (root &amp;&amp; child) {</div><div class="line">    root-&gt;installProgVersion(prg_version);</div><div class="line">    root-&gt;installBugAddress(bug_addr);</div><div class="line"></div><div class="line">    <span class="comment">// add options:</span></div><div class="line">    retval = root-&gt;addOptions(options);</div><div class="line">    <span class="keywordflow">if</span> (retval) {</div><div class="line">      retval = child-&gt;addOptions(sub_options);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">if</span> (retval) {</div><div class="line">      child-&gt;setDocMessage(sub_doc);</div><div class="line">      child-&gt;setUsageMessage(sub_args_doc);</div><div class="line">      root-&gt;setDocMessage(doc);</div><div class="line">      root-&gt;setUsageMessage(args_doc);</div><div class="line">    }</div><div class="line"></div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> retval;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">  prg_name = argv[0];</div><div class="line">  <span class="keywordflow">if</span> (setup_parsers(argc, argv)) {</div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    <span class="comment">// This function might not return ... see comments</span></div><div class="line">    <span class="comment">// in the file &quot;boilerplate.cpp&quot; and in the</span></div><div class="line">    <span class="comment">// documentation for argp++ for an explanation:</span></div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    do_test();</div><div class="line">    <span class="comment">//-------------------------------------------------------------------</span></div><div class="line">    <span class="comment">// We could have made params_ a global variable, but instead it is a</span></div><div class="line">    <span class="comment">// public member of Argex_test. In order to access it now, we have</span></div><div class="line">    <span class="comment">// to do a dynamic_cast because getRootInstance() returns a pointer</span></div><div class="line">    <span class="comment">// to the base class. &quot;Real&quot; code wouldn&#39;t need to do this:</span></div><div class="line">    <span class="comment">//-------------------------------------------------------------------</span></div><div class="line">    Argex_test *root = <span class="keyword">dynamic_cast&lt;</span>Argex_test*<span class="keyword">&gt;</span>(ArgppBase::getRootInstance());</div><div class="line">    <span class="keywordflow">if</span> (root) {</div><div class="line">      <span class="comment">//-------------------------------------------------</span></div><div class="line">      <span class="comment">// It would be nice to have this print out before</span></div><div class="line">      <span class="comment">// the boilerplate code, but it is too much trouble</span></div><div class="line">      <span class="comment">// to change boilerplate.cpp just for this:</span></div><div class="line">      <span class="comment">//-------------------------------------------------</span></div><div class="line">      printf (<span class="stringliteral">&quot;==============================\nAfter parsing: foonly = %x\n&quot;</span>, root-&gt;params_.foonly);</div><div class="line">    }</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
<hr/>
<h1><a class="anchor" id="step0"></a>
ex_step_0.cpp</h1>
<p><span style="background-color:yellow"> A minimal argp++ application with no options except for the built-ins: <code>--help</code>, <code>--usage</code> and <code>--version</code>. </span> <br />
 <br />
Taken from the "step" examples in the book <a href="http://www.nongnu.org/argpbook/" target="_blank" style="font-style:italic;font-weight:bold">&ldquo;Step-By-Step Into Argp&rdquo;</a>&#160;by Ben Asselstine (Copyright &copy; 2010, 2015). </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">   Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">   modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">   version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">   Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">   Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">   Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">   Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">string</span> prg_name;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version = <span class="stringliteral">&quot;version 1.0&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> bug_addr    = <span class="stringliteral">&quot;&lt;code@roberthairgrove.com&gt;&quot;</span>;</div><div class="line"></div><div class="line"><span class="comment">// Implementation of this function is in boilerplate.cpp:</span></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> do_test();</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="keyword">class </span>Argex_0 : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">      Argex_0(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">          : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent)</div><div class="line">      {}</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">      <span class="comment">//---------------------------------------------------------</span></div><div class="line">      <span class="comment">// Since parserImpl() is a pure virtual function in the</span></div><div class="line">      <span class="comment">// base class, we must provide an implementation of it.</span></div><div class="line">      <span class="comment">// This one simply returns the standard ARGPP_SUCCESS</span></div><div class="line">      <span class="comment">// return code (which is == 0).</span></div><div class="line">      <span class="comment">//</span></div><div class="line">      <span class="comment">// Admittedly, this class is pretty useless!</span></div><div class="line">      <span class="comment">// But it shows how little work is necessary to provide</span></div><div class="line">      <span class="comment">// the basic functionality of the standard options:</span></div><div class="line">      <span class="comment">// --help, --usage, and --version.</span></div><div class="line">      <span class="comment">//---------------------------------------------------------</span></div><div class="line">      error_t parserImpl(<span class="keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *, argp_state *)</div><div class="line">      { <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>; }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">bool</span> setup_parsers(<span class="keywordtype">int</span> cargc, <span class="keywordtype">char</span>** vargv) {</div><div class="line">  <span class="comment">//--------------------------</span></div><div class="line">  <span class="comment">// create the root instance:</span></div><div class="line">  <span class="comment">//--------------------------</span></div><div class="line">  Argex_0* root = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_0&gt;::createParser</a>(cargc, vargv);</div><div class="line">  <span class="keywordflow">if</span> (root) {</div><div class="line">    root-&gt;installProgVersion(prg_version);</div><div class="line">    root-&gt;installBugAddress(bug_addr);</div><div class="line">  }</div><div class="line">  <span class="comment">//------------------------------------------------------</span></div><div class="line">  <span class="comment">// We have no parsers to set up, so we can just return:</span></div><div class="line">  <span class="comment">//------------------------------------------------------</span></div><div class="line">  <span class="keywordflow">return</span> (<span class="keywordtype">bool</span>)root;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">  prg_name = argv[0];</div><div class="line">  <span class="keywordflow">if</span> (setup_parsers(argc, argv)) {</div><div class="line">    <span class="comment">//------------------------------------------------</span></div><div class="line">    <span class="comment">// This function might not return ... see comments</span></div><div class="line">    <span class="comment">// in the file &quot;boilerplate.cpp&quot; and in the other</span></div><div class="line">    <span class="comment">// documentation for argp++ for an explanation:</span></div><div class="line">    <span class="comment">//------------------------------------------------</span></div><div class="line">    do_test();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
<hr/>
<h1><a class="anchor" id="step1"></a>
ex_step_1.cpp</h1>
<p><span style="background-color:yellow"> An Argp-enabled program with one option. </span> <br />
 <br />
Taken from the "step" examples in the book <a href="http://www.nongnu.org/argpbook/" target="_blank" style="font-style:italic;font-weight:bold">&ldquo;Step-By-Step Into Argp&rdquo;</a>&#160;by Ben Asselstine (Copyright &copy; 2010, 2015). </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">    ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">    Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">    modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">    License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">    version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">    Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">    License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">    Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">    Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">    Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">string</span> prg_name;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version = <span class="stringliteral">&quot;version 1.0&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> bug_addr    = <span class="stringliteral">&quot;&lt;code@roberthairgrove.com&gt;&quot;</span>;</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> do_test();</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="keyword">class </span>Argex_1 : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Argex_1(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">      : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent)</div><div class="line">    {}</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    error_t parserImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *state) {</div><div class="line">      <span class="comment">//--------------------------------------</span></div><div class="line">      <span class="comment">// Record this as a parsed option.</span></div><div class="line">      <span class="comment">// (NOTE: The actions following this</span></div><div class="line">      <span class="comment">// could have been deferred until</span></div><div class="line">      <span class="comment">// later, which would help keep</span></div><div class="line">      <span class="comment">// the code from becoming cluttered.)</span></div><div class="line">      <span class="comment">//--------------------------------------</span></div><div class="line">      genericParserImpl(key, arg, state);</div><div class="line">      <span class="comment">//--------------------------------------</span></div><div class="line">      <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;d&#39;</span>) {</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; endl;</div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">bool</span> setup_parsers(<span class="keywordtype">int</span> cargc, <span class="keywordtype">char</span>** vargv) {</div><div class="line"></div><div class="line">  <span class="keywordtype">bool</span> retval = <span class="keyword">false</span>;</div><div class="line">  <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line"></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = <span class="charliteral">&#39;d&#39;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12aa8d9a3a653336a6ba34a7386a12ae17b">opt_arg_is_mandatory</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show a dot on the screen&quot;</span>;</div><div class="line"></div><div class="line">  <span class="comment">// create the root parser instance:</span></div><div class="line">  Argex_1* root = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_1&gt;::createParser</a>(cargc, vargv);</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (root) {</div><div class="line">    root-&gt;installProgVersion(prg_version);</div><div class="line">    root-&gt;installBugAddress(bug_addr);</div><div class="line"></div><div class="line">    <span class="comment">// add options:</span></div><div class="line">    retval = root-&gt;addOption(opt);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> retval;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">  prg_name = argv[0];</div><div class="line">  <span class="keywordflow">if</span> (setup_parsers(argc, argv)) {</div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    <span class="comment">// This function might not return ... see comments</span></div><div class="line">    <span class="comment">// in the file &quot;boilerplate.cpp&quot; and in the</span></div><div class="line">    <span class="comment">// documentation for argp++ for an explanation:</span></div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    do_test();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
<hr/>
<h1><a class="anchor" id="step2"></a>
ex_step_2.cpp</h1>
<p><span style="background-color:yellow"> An Argp-enabled program with an option that has a mandatory argument. </span> <br />
 <br />
Taken from the "step" examples in the book <a href="http://www.nongnu.org/argpbook/" target="_blank" style="font-style:italic;font-weight:bold">&ldquo;Step-By-Step Into Argp&rdquo;</a>&#160;by Ben Asselstine (Copyright &copy; 2010, 2015). </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">   Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">   modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">   version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">   Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">   Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">   Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">   Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">string</span> prg_name;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version = <span class="stringliteral">&quot;version 1.0&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> bug_addr    = <span class="stringliteral">&quot;&lt;code@roberthairgrove.com&gt;&quot;</span>;</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> do_test();</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="keyword">class </span>Argex_2 : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Argex_2(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">      : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent)</div><div class="line">    {}</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    error_t parserImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *) {</div><div class="line">      <span class="comment">//--------------------------------------</span></div><div class="line">      <span class="comment">// Record this as a parsed option.</span></div><div class="line">      <span class="comment">// The actions taken within this switch</span></div><div class="line">      <span class="comment">// statement could have been deferred until</span></div><div class="line">      <span class="comment">// later this way, which would help keep</span></div><div class="line">      <span class="comment">// the code from becoming cluttered.</span></div><div class="line">      <span class="comment">//</span></div><div class="line">      <span class="comment">// Another way of doing the same thing </span></div><div class="line">      <span class="comment">// would be to call the genericParserImpl()</span></div><div class="line">      <span class="comment">// member function in the base class.</span></div><div class="line">      <span class="comment">// But I am leaving this in for illustration</span></div><div class="line">      <span class="comment">// purposes:</span></div><div class="line">      <span class="comment">//--------------------------------------</span></div><div class="line">      <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line">      <span class="keywordflow">if</span> (findOption(key, opt)) {</div><div class="line">        addParsedOption(key, opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>, arg);</div><div class="line">      }</div><div class="line">      <span class="comment">//--------------------------------------</span></div><div class="line">      <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;d&#39;</span>) {</div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c = strtoul(arg, NULL, 10);</div><div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; c; i++) {</div><div class="line">          cout &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div><div class="line">        }</div><div class="line">        cout &lt;&lt; endl;</div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">bool</span> setup_parsers(<span class="keywordtype">int</span> cargc, <span class="keywordtype">char</span>** vargv) {</div><div class="line"></div><div class="line">  <span class="keywordtype">bool</span> retval = <span class="keyword">false</span>;</div><div class="line">  <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line"></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = <span class="charliteral">&#39;d&#39;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>           = <span class="stringliteral">&quot;NUM&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12aa8d9a3a653336a6ba34a7386a12ae17b">opt_arg_is_mandatory</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show some dots on the screen&quot;</span>;</div><div class="line"></div><div class="line">  <span class="comment">// create the root parser instance:</span></div><div class="line">  Argex_2* root = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_2&gt;::createParser</a>(cargc, vargv);</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (root) {</div><div class="line">    root-&gt;installProgVersion(prg_version);</div><div class="line">    root-&gt;installBugAddress(bug_addr);</div><div class="line"></div><div class="line">    <span class="comment">// add options:</span></div><div class="line">    retval = root-&gt;addOption(opt);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> retval;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">  prg_name = argv[0];</div><div class="line">  <span class="keywordflow">if</span> (setup_parsers(argc, argv)) {</div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    <span class="comment">// This function might not return ... see comments</span></div><div class="line">    <span class="comment">// in the file &quot;boilerplate.cpp&quot; and in the</span></div><div class="line">    <span class="comment">// documentation for argp++ for an explanation:</span></div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    do_test();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
<hr/>
<h1><a class="anchor" id="step3"></a>
ex_step_3.cpp</h1>
<p><span style="background-color:yellow"> An Argp-enabled program with a long option that has a mandatory argument. </span> <br />
 <br />
Taken from the "step" examples in the book <a href="http://www.nongnu.org/argpbook/" target="_blank" style="font-style:italic;font-weight:bold">&ldquo;Step-By-Step Into Argp&rdquo;</a>&#160;by Ben Asselstine (Copyright &copy; 2010, 2015). </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* </span></div><div class="line"><span class="comment">    ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">    Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">    modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">    License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">    version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">    Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">    License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">    Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">    Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">    Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">string</span> prg_name;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version = <span class="stringliteral">&quot;version 1.0&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> bug_addr    = <span class="stringliteral">&quot;&lt;code@roberthairgrove.com&gt;&quot;</span>;</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> do_test();</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="keyword">class </span>Argex_3 : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Argex_3(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">      : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent)</div><div class="line">    {}</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    error_t parserImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *) {</div><div class="line">      <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;d&#39;</span>) {</div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c = strtoul(arg, NULL, 10);</div><div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; c; i++) {</div><div class="line">          cout &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div><div class="line">        }</div><div class="line">        cout &lt;&lt; endl;</div><div class="line">        <span class="comment">// record parsed option:</span></div><div class="line">        addParsedOption(key, <span class="keywordtype">string</span>(), arg);</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">bool</span> setup_parsers(<span class="keywordtype">int</span> cargc, <span class="keywordtype">char</span>** vargv) {</div><div class="line"></div><div class="line">  <span class="keywordtype">bool</span> retval = <span class="keyword">false</span>;</div><div class="line">  <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line"></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = <span class="charliteral">&#39;d&#39;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;dot&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>           = <span class="stringliteral">&quot;NUM&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12aa8d9a3a653336a6ba34a7386a12ae17b">opt_arg_is_mandatory</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show some dots on the screen&quot;</span>;</div><div class="line"></div><div class="line">  <span class="comment">// create the root instance:</span></div><div class="line">  Argex_3* root = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_3&gt;::createParser</a>(cargc, vargv);</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (root) {</div><div class="line">    root-&gt;installProgVersion(prg_version);</div><div class="line">    root-&gt;installBugAddress(bug_addr);</div><div class="line"></div><div class="line">    <span class="comment">// add options:</span></div><div class="line">    retval = root-&gt;addOption(opt);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> retval;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">  prg_name = argv[0];</div><div class="line">  <span class="keywordflow">if</span> (setup_parsers(argc, argv)) {</div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    <span class="comment">// This function might not return ... see comments</span></div><div class="line">    <span class="comment">// in the file &quot;boilerplate.cpp&quot; and in the</span></div><div class="line">    <span class="comment">// documentation for argp++ for an explanation:</span></div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    do_test();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
<hr/>
<h1><a class="anchor" id="step4"></a>
ex_step_4.cpp</h1>
<p><span style="background-color:yellow"> An Argp-enabled program with a long option that has an optional argument. </span> <br />
 <br />
Taken from the "step" examples in the book <a href="http://www.nongnu.org/argpbook/" target="_blank" style="font-style:italic;font-weight:bold">&ldquo;Step-By-Step Into Argp&rdquo;</a>&#160;by Ben Asselstine (Copyright &copy; 2010, 2015). </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">    ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">    Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">    modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">    License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">    version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">    Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">    License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">    Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">    Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">    Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">string</span> prg_name;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version = <span class="stringliteral">&quot;version 1.0&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> bug_addr    = <span class="stringliteral">&quot;&lt;code@roberthairgrove.com&gt;&quot;</span>;</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> do_test();</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="keyword">class </span>Argex_4 : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Argex_4(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">      : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent)</div><div class="line">    {}</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    error_t parserImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *) {</div><div class="line">      <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;d&#39;</span>) {</div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dots = 0;</div><div class="line">        <span class="keywordflow">if</span> (arg == NULL) {</div><div class="line">          dots = 1;</div><div class="line">        } <span class="keywordflow">else</span> {</div><div class="line">          dots = strtoul(arg, NULL, 10);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; dots; i++) {</div><div class="line">          cout &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div><div class="line">        }</div><div class="line">        cout &lt;&lt; endl;</div><div class="line">        <span class="comment">//-------------------------------</span></div><div class="line">        <span class="comment">// record the parsed option:</span></div><div class="line">        <span class="comment">//-------------------------------</span></div><div class="line">        <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line">        <span class="keywordflow">if</span> (findOption(key, opt)) {</div><div class="line">          <span class="keywordflow">if</span> (arg) {</div><div class="line">            addParsedOption(key, opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>, arg);</div><div class="line">          } <span class="keywordflow">else</span> {</div><div class="line">            addParsedOption(key, opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>);</div><div class="line">          }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">bool</span> setup_parsers(<span class="keywordtype">int</span> cargc, <span class="keywordtype">char</span>** vargv) {</div><div class="line"></div><div class="line">  <span class="keywordtype">bool</span> retval = <span class="keyword">false</span>;</div><div class="line">  <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line"></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = <span class="charliteral">&#39;d&#39;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;dot&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>           = <span class="stringliteral">&quot;NUM&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12a6da3ce7fd0c076f273e755ce84096cee">opt_arg_is_optional</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show some dots on the screen&quot;</span>;</div><div class="line"></div><div class="line">  <span class="comment">// create the root instance:</span></div><div class="line">  Argex_4* root = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_4&gt;::createParser</a>(cargc, vargv);</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (root) {</div><div class="line">    root-&gt;installProgVersion(prg_version);</div><div class="line">    root-&gt;installBugAddress(bug_addr);</div><div class="line"></div><div class="line">    <span class="comment">// add options:</span></div><div class="line">    retval = root-&gt;addOption(opt);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> retval;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">  prg_name = argv[0];</div><div class="line">  <span class="keywordflow">if</span> (setup_parsers(argc, argv)) {</div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    <span class="comment">// This function might not return ... see comments</span></div><div class="line">    <span class="comment">// in the file &quot;boilerplate.cpp&quot; and in the</span></div><div class="line">    <span class="comment">// documentation for argp++ for an explanation:</span></div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    do_test();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
<hr/>
<h1><a class="anchor" id="step5"></a>
ex_step_5.cpp</h1>
<p><span style="background-color:yellow"> An Argp-enabled program with an aliased long option. </span> <br />
 <br />
Taken from the "step" examples in the book <a href="http://www.nongnu.org/argpbook/" target="_blank" style="font-style:italic;font-weight:bold">&ldquo;Step-By-Step Into Argp&rdquo;</a>&#160;by Ben Asselstine (Copyright &copy; 2010, 2015). </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">   Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">   modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">   version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">   Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">   Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">   Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">   Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">string</span> prg_name;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version = <span class="stringliteral">&quot;version 1.0&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> bug_addr    = <span class="stringliteral">&quot;&lt;code@roberthairgrove.com&gt;&quot;</span>;</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> do_test();</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="comment"></span><span class="keyword">class </span>Argex_5 : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">argpp::ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Argex_5(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">      : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent)</div><div class="line">    {}</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    error_t parserImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *) {</div><div class="line">      <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;d&#39;</span>) {</div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dots = 0;</div><div class="line">        <span class="keywordflow">if</span> (arg == NULL) {</div><div class="line">          dots = 1;</div><div class="line">        } <span class="keywordflow">else</span> {</div><div class="line">          dots = strtoul(arg, NULL, 10);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; dots; i++) {</div><div class="line">          cout &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div><div class="line">        }</div><div class="line">        cout &lt;&lt; endl;</div><div class="line">        <span class="comment">//------------------------------------</span></div><div class="line">        <span class="comment">// We could have recorded the parsed</span></div><div class="line">        <span class="comment">// option here, but we cannot distinguish</span></div><div class="line">        <span class="comment">// between &#39;d&#39;, &quot;dot&quot; and &quot;period&quot;, so</span></div><div class="line">        <span class="comment">// we&#39;ll just let it ride...</span></div><div class="line">        <span class="comment">//------------------------------------</span></div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">bool</span> setup_parsers(<span class="keywordtype">int</span> cargc, <span class="keywordtype">char</span>** vargv) {</div><div class="line"></div><div class="line">  <span class="keywordtype">bool</span> retval = <span class="keyword">false</span>;</div><div class="line">  <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line">  <span class="comment">//-----------------------------------------------</span></div><div class="line">  <span class="comment">// We will add all of the options at once</span></div><div class="line">  <span class="comment">// by passing this vector:</span></div><div class="line">  <span class="comment">// the base class takes care of delimiting</span></div><div class="line">  <span class="comment">// the array of argp_option structs by appending</span></div><div class="line">  <span class="comment">// an empty argp_option when the time comes to</span></div><div class="line">  <span class="comment">// call the native argp_parse() function:</span></div><div class="line">  <span class="comment">//-----------------------------------------------</span></div><div class="line">  <a class="code" href="../../d2/de7/a00014.html#a160acd8adf776c633e0ff8632293f8a4">ArgppOptions</a> opts;</div><div class="line"></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = <span class="charliteral">&#39;d&#39;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;dot&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>           = <span class="stringliteral">&quot;NUM&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12a6da3ce7fd0c076f273e755ce84096cee">opt_arg_is_optional</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show some dots on the screen&quot;</span>;</div><div class="line"></div><div class="line">  opts.push_back(opt);</div><div class="line"></div><div class="line">  <span class="comment">// 2nd option:</span></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = 0;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;period&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>           = <span class="stringliteral">&quot;FOO&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12ace65715d9e4b0c264faf70fec9eda9b9">opt_is_alias</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Bar&quot;</span>;</div><div class="line"></div><div class="line">  opts.push_back(opt);</div><div class="line"></div><div class="line"></div><div class="line">  <span class="comment">// create the root instance:</span></div><div class="line">  Argex_5* root = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_5&gt;::createParser</a>(cargc, vargv);</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (root) {</div><div class="line">    root-&gt;installProgVersion(prg_version);</div><div class="line">    root-&gt;installBugAddress(bug_addr);</div><div class="line"></div><div class="line">    <span class="comment">// add options:</span></div><div class="line">    retval = root-&gt;addOptions(opts);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> retval;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">  prg_name = argv[0];</div><div class="line">  <span class="keywordflow">if</span> (setup_parsers(argc, argv)) {</div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    <span class="comment">// This function might not return ... see comments</span></div><div class="line">    <span class="comment">// in the file &quot;boilerplate.cpp&quot; and in the</span></div><div class="line">    <span class="comment">// documentation for argp++ for an explanation:</span></div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    do_test();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
<hr/>
<h1><a class="anchor" id="step6"></a>
ex_step_6.cpp</h1>
<p><span style="background-color:yellow"> An Argp-enabled program that calls its own callback function. </span> <br />
 <br />
Taken from the "step" examples in the book <a href="http://www.nongnu.org/argpbook/" target="_blank" style="font-style:italic;font-weight:bold">&ldquo;Step-By-Step Into Argp&rdquo;</a>&#160;by Ben Asselstine (Copyright &copy; 2010, 2015). </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">   Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">   modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">   version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">   Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">   Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">   Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">   Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">string</span> prg_name;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version = <span class="stringliteral">&quot;version 1.0&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> bug_addr    = <span class="stringliteral">&quot;&lt;code@roberthairgrove.com&gt;&quot;</span>;</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> do_test();</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keyword">class </span>Argex_6 : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">argpp::ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Argex_6(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">      : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent)</div><div class="line">    {}</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    error_t parserImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *state) {</div><div class="line">      <span class="comment">// record it:</span></div><div class="line">      genericParserImpl(key, arg, state);</div><div class="line"></div><div class="line">      error_t retval = <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>;</div><div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, dots;</div><div class="line"></div><div class="line">      <span class="keywordflow">switch</span> (key) {</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div><div class="line">          dots = strtoul(arg, NULL, 10);</div><div class="line">          <span class="keywordflow">for</span> (i = 0; i &lt; dots; i++) {</div><div class="line">            cout &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div><div class="line">          }</div><div class="line">          cout &lt;&lt; endl;</div><div class="line">          retval = <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">          <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> 777:</div><div class="line">          retval = this-&gt;parserImpl(<span class="charliteral">&#39;d&#39;</span>, <span class="stringliteral">&quot;3&quot;</span>, state);</div><div class="line">          <span class="keywordflow">break</span>;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> retval;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">bool</span> setup_parsers(<span class="keywordtype">int</span> cargc, <span class="keywordtype">char</span>** vargv) {</div><div class="line"></div><div class="line">  <span class="keywordtype">bool</span> retval = <span class="keyword">false</span>;</div><div class="line">  <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line">  <span class="comment">//-----------------------------------------------</span></div><div class="line">  <span class="comment">// We will add all of the options at once</span></div><div class="line">  <span class="comment">// by passing this vector:</span></div><div class="line">  <span class="comment">// the base class takes care of delimiting</span></div><div class="line">  <span class="comment">// the array of argp_option structs by appending</span></div><div class="line">  <span class="comment">// an empty argp_option when the time comes to</span></div><div class="line">  <span class="comment">// call the native argp_parse() function:</span></div><div class="line">  <span class="comment">//-----------------------------------------------</span></div><div class="line">  <a class="code" href="../../d2/de7/a00014.html#a160acd8adf776c633e0ff8632293f8a4">ArgppOptions</a> opts;</div><div class="line"></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = <span class="charliteral">&#39;d&#39;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;dot&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>           = <span class="stringliteral">&quot;NUM&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12aa8d9a3a653336a6ba34a7386a12ae17b">opt_arg_is_mandatory</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show some dots on the screen&quot;</span>;</div><div class="line"></div><div class="line">  opts.push_back(opt);</div><div class="line"></div><div class="line">  <span class="comment">// 2nd option:</span></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = 777;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;ellipsis&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>.clear();</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12aa8d9a3a653336a6ba34a7386a12ae17b">opt_arg_is_mandatory</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show an ellipsis on the screen&quot;</span>;</div><div class="line"></div><div class="line">  opts.push_back(opt);</div><div class="line"></div><div class="line"></div><div class="line">  <span class="comment">// create the root instance:</span></div><div class="line">  Argex_6* root = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_6&gt;::createParser</a>(cargc, vargv);</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (root) {</div><div class="line">    root-&gt;installProgVersion(prg_version);</div><div class="line">    root-&gt;installBugAddress(bug_addr);</div><div class="line"></div><div class="line">    <span class="comment">// add options:</span></div><div class="line">    retval = root-&gt;addOptions(opts);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> retval;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">  prg_name = argv[0];</div><div class="line">  <span class="keywordflow">if</span> (setup_parsers(argc, argv)) {</div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    <span class="comment">// This function might not return ... see comments</span></div><div class="line">    <span class="comment">// in the file &quot;boilerplate.cpp&quot; and in the</span></div><div class="line">    <span class="comment">// documentation for argp++ for an explanation:</span></div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    do_test();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
<hr/>
<h1><a class="anchor" id="step7"></a>
ex_step_7.cpp</h1>
<p><span style="background-color:yellow"> An Argp-enabled program that accepts arguments. Callback funcion. Illustrates use of the <em>argppFailure</em> member function as well as overriding the virtual <em>keyArgImpl</em> and <em>keyEndImpl</em> members. Also illustrates the <em>setUsageMessage</em> member function to set the <code>argp_doc</code> string. </span> <br />
 <br />
Taken from the "step" examples in the book <a href="http://www.nongnu.org/argpbook/" target="_blank" style="font-style:italic;font-weight:bold">&ldquo;Step-By-Step Into Argp&rdquo;</a>&#160;by Ben Asselstine (Copyright &copy; 2010, 2015). </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">    ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">    Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">    modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">    License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">    version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">    Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">    License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">    The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">    Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">    Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">    Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">string</span> prg_name;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version = <span class="stringliteral">&quot;version 1.0&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> bug_addr    = <span class="stringliteral">&quot;&lt;code@roberthairgrove.com&gt;&quot;</span>;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_ARG_COUNT = 4;</div><div class="line"></div><div class="line"><span class="comment">//-----------------------------------------------</span></div><div class="line"><span class="comment">// By setting this to false, we would not record</span></div><div class="line"><span class="comment">// any of the non-option arguments given on the</span></div><div class="line"><span class="comment">// command line:</span></div><div class="line"><span class="comment">//-----------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> TRACK_ARGS = <span class="keyword">true</span>;</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> do_test();</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keyword">class </span>Argex_7 : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">argpp::ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Argex_7(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">      : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent)</div><div class="line">      , arg_count_(MAX_ARG_COUNT)</div><div class="line">      , track_args_(TRACK_ARGS)</div><div class="line">    {}</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    <span class="keywordtype">int</span> arg_count_;</div><div class="line">    <span class="keywordtype">bool</span> track_args_;</div><div class="line"></div><div class="line">    error_t parserImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *state) {</div><div class="line">      <span class="comment">// record it:</span></div><div class="line">      genericParserImpl(key, arg, state);</div><div class="line"></div><div class="line">      error_t retval = <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>;</div><div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, dots;</div><div class="line"></div><div class="line">      <span class="keywordflow">switch</span> (key) {</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div><div class="line">          <span class="comment">// Argument to &quot;d&quot; is mandatory, therefore</span></div><div class="line">          <span class="comment">// we shouldn&#39;t need to check arg here...</span></div><div class="line">          <span class="comment">// but it might be wise in production code:</span></div><div class="line">          <span class="keywordflow">if</span> (arg) {</div><div class="line">            dots = strtoul(arg, NULL, 10);</div><div class="line">            <span class="keywordflow">for</span> (i = 0; i &lt; dots; i++) {</div><div class="line">              cout &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div><div class="line">            }</div><div class="line">            <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line">            <span class="keywordflow">if</span> (findOption(key, opt)) {</div><div class="line">              addParsedOption(key, opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>, <span class="keywordtype">string</span>(arg));</div><div class="line">            }</div><div class="line">            retval = <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">          } <span class="keywordflow">else</span> {</div><div class="line">            retval = <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>;</div><div class="line">          }</div><div class="line">          <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> 777:</div><div class="line">          <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line">          <span class="keywordflow">if</span> (findOption(key, opt)) {</div><div class="line">            addParsedOption(key, opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>, <span class="keywordtype">string</span>());</div><div class="line">          }</div><div class="line">          retval = this-&gt;parserImpl(<span class="charliteral">&#39;d&#39;</span>, <span class="stringliteral">&quot;3&quot;</span>, state);</div><div class="line">          <span class="keywordflow">break</span>;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> retval;</div><div class="line">    }</div><div class="line"></div><div class="line">    error_t keyArgImpl(<span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *) {</div><div class="line">      --arg_count_;</div><div class="line">      <span class="keywordflow">if</span> (arg &amp;&amp; track_args_) {</div><div class="line">        addNonOptionArg(arg);</div><div class="line">      }</div><div class="line">      <span class="keywordflow">if</span> (arg_count_ &gt;= 0) {</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; arg;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">    }</div><div class="line"></div><div class="line">    error_t keyEndImpl(argp_state *state) {</div><div class="line">      cout &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">if</span> (arg_count_ &gt;= MAX_ARG_COUNT) {</div><div class="line">        ArgppBase::argppFailure(state, 1, 0, <span class="stringliteral">&quot;too few arguments&quot;</span>);</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (arg_count_ &lt; 0) {</div><div class="line">        ArgppBase::argppFailure(state, 1, 0, <span class="stringliteral">&quot;too many arguments&quot;</span>);</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">bool</span> setup_parsers(<span class="keywordtype">int</span> cargc, <span class="keywordtype">char</span>** vargv) {</div><div class="line"></div><div class="line">  <span class="keywordtype">bool</span> retval = <span class="keyword">false</span>;</div><div class="line">  <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line">  <span class="comment">//-----------------------------------------------</span></div><div class="line">  <span class="comment">// We will add all of the options at once</span></div><div class="line">  <span class="comment">// by passing this vector:</span></div><div class="line">  <span class="comment">// the base class takes care of delimiting</span></div><div class="line">  <span class="comment">// the array of argp_option structs by appending</span></div><div class="line">  <span class="comment">// an empty argp_option when the time comes to</span></div><div class="line">  <span class="comment">// call the native argp_parse() function:</span></div><div class="line">  <span class="comment">//-----------------------------------------------</span></div><div class="line">  <a class="code" href="../../d2/de7/a00014.html#a160acd8adf776c633e0ff8632293f8a4">ArgppOptions</a> opts;</div><div class="line"></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = <span class="charliteral">&#39;d&#39;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;dot&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>           = <span class="stringliteral">&quot;NUM&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12aa8d9a3a653336a6ba34a7386a12ae17b">opt_arg_is_mandatory</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show some dots on the screen&quot;</span>;</div><div class="line"></div><div class="line">  opts.push_back(opt);</div><div class="line"></div><div class="line">  <span class="comment">// 2nd option:</span></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = 777;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;ellipsis&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>.clear();</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12aa8d9a3a653336a6ba34a7386a12ae17b">opt_arg_is_mandatory</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show an ellipsis on the screen&quot;</span>;</div><div class="line"></div><div class="line">  opts.push_back(opt);</div><div class="line"></div><div class="line"></div><div class="line">  <span class="comment">// create the root instance:</span></div><div class="line">  Argex_7* root = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_7&gt;::createParser</a>(cargc, vargv);</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (root) {</div><div class="line">    root-&gt;installProgVersion(prg_version);</div><div class="line">    root-&gt;installBugAddress(bug_addr);</div><div class="line"></div><div class="line">    <span class="comment">// add options:</span></div><div class="line">    retval = root-&gt;addOptions(opts);</div><div class="line"></div><div class="line">    <span class="comment">// set argp_doc string for &quot;Usage&quot; message:</span></div><div class="line">    root-&gt;setUsageMessage(<span class="stringliteral">&quot;WORD [WORD [WORD [WORD]]]&quot;</span>);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> retval;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">  prg_name = argv[0];</div><div class="line">  <span class="keywordflow">if</span> (setup_parsers(argc, argv)) {</div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    <span class="comment">// This function might not return ... see comments</span></div><div class="line">    <span class="comment">// in the file &quot;boilerplate.cpp&quot; and in the</span></div><div class="line">    <span class="comment">// documentation for argp++ for an explanation:</span></div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    do_test();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
<hr/>
<h1><a class="anchor" id="step8"></a>
ex_step_8.cpp</h1>
<p><span style="background-color:yellow"> An Argp-enabled program that accepts a hidden option. Callback function. </span> <br />
 <br />
Taken from the "step" examples in the book <a href="http://www.nongnu.org/argpbook/" target="_blank" style="font-style:italic;font-weight:bold">&ldquo;Step-By-Step Into Argp&rdquo;</a>&#160;by Ben Asselstine (Copyright &copy; 2010, 2015). </p>
<p><a href="../../#">Back to top...</a></p>
<p>Source code: </p><div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* ARGP++ is a C++ wrapper library around the GNU argp library.</span></div><div class="line"><span class="comment">   Copyright (C) 2017 by Robert Hairgrove &lt;code@roberthairgrove.com&gt;.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is free software; you can redistribute it and/or</span></div><div class="line"><span class="comment">   modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment">   version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment">   Lesser General Public License for more details.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment">   License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment">   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   The argp library is part of the GNU C Library.</span></div><div class="line"><span class="comment">   Written by Miles Bader &lt;miles@gnu.ai.mit.edu&gt;.</span></div><div class="line"><span class="comment">   Copyright (C) 1995-1999, 2003, 2004, 2005, 2006, 2007, 2009</span></div><div class="line"><span class="comment">   Free Software Foundation, Inc.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;../../include/argpp.hpp&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d7/d7a/a00016.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/de7/a00014.html">argpp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">string</span> prg_name;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> prg_version = <span class="stringliteral">&quot;version 1.0&quot;</span>;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">string</span> bug_addr    = <span class="stringliteral">&quot;&lt;code@roberthairgrove.com&gt;&quot;</span>;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_ARG_COUNT = 4;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> TRACK_ARGS = <span class="keyword">true</span>;</div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> do_test();</div><div class="line"></div><div class="line"><span class="keyword">class </span>Argex_8 : <span class="keyword">public</span> <a class="code" href="../../d1/d7c/a00003.html">argpp::ArgppBase</a> {</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    Argex_8(<span class="keywordtype">int</span> cargs, <span class="keywordtype">char</span>** vargs, <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>* parent)</div><div class="line">      : <a class="code" href="../../d1/d7c/a00003.html">ArgppBase</a>(cargs, vargs, parent)</div><div class="line">    {}</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    error_t parserImpl(<span class="keywordtype">int</span> key, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg, argp_state *state) {</div><div class="line">      <span class="comment">// record it:</span></div><div class="line">      genericParserImpl(key, arg, state);</div><div class="line">      </div><div class="line">      error_t retval = <a class="code" href="../../da/da0/a00009.html#a7588ea393bd34d50cf132942a6e70487">ARGPP_UNKNOWN</a>;</div><div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, dots;</div><div class="line"></div><div class="line">      <span class="keywordflow">switch</span> (key) {</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div><div class="line">          <span class="comment">// Argument to &quot;d&quot; is mandatory, therefore</span></div><div class="line">          <span class="comment">// we shouldn&#39;t need to check arg here...</span></div><div class="line">          <span class="comment">// but it might be wise in production code:</span></div><div class="line">          <span class="keywordflow">if</span> (arg) {</div><div class="line">            dots = strtoul(arg, NULL, 10);</div><div class="line">          } <span class="keywordflow">else</span> {</div><div class="line">            dots = 1;</div><div class="line">          }</div><div class="line">          <span class="keywordflow">for</span> (i = 0; i &lt; dots; i++) {</div><div class="line">            cout &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div><div class="line">          }</div><div class="line">          retval = <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">          <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> 777:</div><div class="line">          retval = this-&gt;parserImpl(<span class="charliteral">&#39;d&#39;</span>, <span class="stringliteral">&quot;3&quot;</span>, state);</div><div class="line">          <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> 888:</div><div class="line">          cout &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> retval;</div><div class="line">    }</div><div class="line">    error_t keyArgImpl(<span class="keyword">const</span> <span class="keywordtype">char</span> *, argp_state *state) {</div><div class="line">      ArgppBase::argppFailure(state, 1, 0, <span class="stringliteral">&quot;too many arguments&quot;</span>);</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">    }</div><div class="line">    error_t keyEndImpl(argp_state *) {</div><div class="line">      cout &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span> <a class="code" href="../../da/da0/a00009.html#a0e36c69db3002c9415ec5973eb08f932">ARGPP_SUCCESS</a>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">bool</span> setup_parsers(<span class="keywordtype">int</span> cargc, <span class="keywordtype">char</span>** vargv) {</div><div class="line"></div><div class="line">  <span class="keywordtype">bool</span> retval = <span class="keyword">false</span>;</div><div class="line">  <a class="code" href="../../dd/dad/a00005.html">ArgppOption</a> opt;</div><div class="line">  <span class="comment">//-----------------------------------------------</span></div><div class="line">  <span class="comment">// We will add all of the options at once</span></div><div class="line">  <span class="comment">// by passing this vector:</span></div><div class="line">  <span class="comment">// the base class takes care of delimiting</span></div><div class="line">  <span class="comment">// the array of argp_option structs by appending</span></div><div class="line">  <span class="comment">// an empty argp_option when the time comes to</span></div><div class="line">  <span class="comment">// call the native argp_parse() function:</span></div><div class="line">  <span class="comment">//-----------------------------------------------</span></div><div class="line">  <a class="code" href="../../d2/de7/a00014.html#a160acd8adf776c633e0ff8632293f8a4">ArgppOptions</a> opts;</div><div class="line"></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = <span class="charliteral">&#39;d&#39;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;dot&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>           = <span class="stringliteral">&quot;NUM&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12a6da3ce7fd0c076f273e755ce84096cee">opt_arg_is_optional</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show some dots on the screen&quot;</span>;</div><div class="line"></div><div class="line">  opts.push_back(opt);</div><div class="line"></div><div class="line">  <span class="comment">// 2nd option:</span></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = 777;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;ellipsis&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a4d4909e6b4fce67faf853ea09659e21b">arg_</a>.clear();</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12add667e1c8ab1ab6dae6212c6cb5573ca">opt_is_hidden</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show an ellipsis on the screen&quot;</span>;</div><div class="line"></div><div class="line">  opts.push_back(opt);</div><div class="line"></div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a3967e5af993da7a0d88a44697fad26d2">key_</a>           = 888;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aa1972528bbc1666591882bc0b3700aa5">long_name_</a>     = <span class="stringliteral">&quot;dash&quot;</span>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#a71fe7c64cf325952d8befaf0349e8cc7">flags_</a>         = <a class="code" href="../../d2/de7/a00014.html#a3306689a8e68d0a953ec6a6aa7955a12aa8d9a3a653336a6ba34a7386a12ae17b">opt_arg_is_mandatory</a>;</div><div class="line">  opt.<a class="code" href="../../dd/dad/a00005.html#aae57cdf93f8dd7d3e193c0a785b8433e">doc_or_header_</a> = <span class="stringliteral">&quot;Show a dash on the screen&quot;</span>;</div><div class="line"></div><div class="line">  opts.push_back(opt);</div><div class="line"></div><div class="line">  <span class="comment">// create the root instance:</span></div><div class="line">  Argex_8* root = <a class="code" href="../../de/d21/a00006.html">Factory&lt;Argex_8&gt;::createParser</a>(cargc, vargv);</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (root) {</div><div class="line">    root-&gt;installProgVersion(prg_version);</div><div class="line">    root-&gt;installBugAddress(bug_addr);</div><div class="line"></div><div class="line">    <span class="comment">// add options:</span></div><div class="line">    retval = root-&gt;addOptions(opts);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> retval;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">  prg_name = argv[0];</div><div class="line">  <span class="keywordflow">if</span> (setup_parsers(argc, argv)) {</div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    <span class="comment">// This function might not return ... see comments</span></div><div class="line">    <span class="comment">// in the file &quot;boilerplate.cpp&quot; and in the</span></div><div class="line">    <span class="comment">// documentation for argp++ for an explanation:</span></div><div class="line">    <span class="comment">//----------------------------------------------</span></div><div class="line">    do_test();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> <p><a href="../../#">Back to top...</a></p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Jan 22 2017 12:39:37 for Argp++ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
